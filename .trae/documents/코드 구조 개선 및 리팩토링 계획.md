# 코드 구조 개선 및 리팩토링 계획

분석 결과에 따라 변수명 통일, 타입 정의 분리, 로직 추출을 위한 리팩토링 계획을 제안합니다.

## 1. 변수명 통일 (Variable Name Tyding)
코드 전반에 걸쳐 혼재된 변수명을 의미가 명확한 표준 이름으로 통일합니다.

*   **이전 종가 (Previous Close):**
    *   **현황:** `previousClose`, `prev_close`, `yesterdayPrice`가 혼용됨.
    *   **변경:** **`previousClosePrice`**로 통일.
    *   **대상 파일:** `types.ts`, `services/priceService.ts`, `Asset` 인터페이스 관련 파일.
*   **현재가 (Current Price):**
    *   **현황:** `price`, `currentPrice`, `priceKRW` 등이 API 응답과 내부 모델에서 혼용됨.
    *   **변경:** 내부 모델(Asset) 및 가공된 데이터에서는 **`currentPrice`**로 통일.
    *   **대상 파일:** `services/priceService.ts`, `types.ts`.

## 2. 타입 정의 추출 (Type Extraction)
루트 `types.ts`와 컴포넌트 내부에 산재된 타입 정의를 `types/` 디렉토리로 구조화하여 관리합니다.

*   **디렉토리 구조 생성:** `types/` 폴더 생성.
*   **파일 분리:**
    *   `types/index.ts`: 핵심 도메인 모델 (`Asset`, `AssetCategory`, `Currency` 등 - 기존 `types.ts` 내용).
    *   `types/store.ts`: 상태 관리 관련 타입 (`PortfolioContextValue`, `PortfolioState` 등 - `PortfolioContext.tsx`에서 추출).
    *   `types/api.ts`: API 응답 규격 (`PriceItem`, `PriceAPIResponse` 등 - `types.ts` 및 `service` 파일에서 추출).
    *   `types/ui.ts`: UI 전용 타입 (`SortKey`, `PortfolioTableProps` 등 - `components/portfolio-table/types.ts`에서 추출).

## 3. 로직 분리 (Logic Separation)
UI 컴포넌트와 Context에 섞여 있는 비즈니스 로직을 커스텀 훅으로 분리합니다.

*   **`usePortfolioStats` (신규):**
    *   **대상:** `DashboardView.tsx` 내의 `dashboardTotalValue`, `soldAssetsStats` 등 계산 로직과 `PortfolioContext.tsx`의 `totalValue`, `alertCount` 계산 로직.
    *   **목표:** 자산 데이터(`assets`)를 입력받아 통계 및 파생 데이터를 반환하는 순수 계산 훅으로 분리.
*   **`usePortfolioHistory` (신규):**
    *   **대상:** `PortfolioContext.tsx` 내의 `updatePortfolioHistory` (스냅샷 생성 및 업데이트 `useEffect`).
    *   **목표:** 포트폴리오 히스토리 관리 로직을 분리하여 Context 크기 축소.
*   **`usePortfolioExport` (신규):**
    *   **대상:** `PortfolioContext.tsx` 내의 `exportCsv`, `exportJson`, `saveToDrive` 핸들러.
    *   **목표:** 파일 입출력 및 드라이브 저장 로직을 별도 훅으로 분리.

## 실행 순서
1.  `types/` 디렉토리 생성 및 타입 파일 분리/이동.
2.  `services/priceService.ts` 및 관련 타입에서 변수명 변경 (`prev_close` -> `previousClosePrice` 등).
3.  `hooks/` 폴더에 신규 훅(`usePortfolioStats`, `usePortfolioHistory`, `usePortfolioExport`) 작성.
4.  `PortfolioContext.tsx` 및 `DashboardView.tsx`에서 분리된 타입과 훅을 적용하여 리팩토링.
